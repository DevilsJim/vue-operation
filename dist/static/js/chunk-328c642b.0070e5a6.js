(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-328c642b"],{"02f3":function(e,t,a){},"19de":function(e,t){e.exports=function(e,t,a,n){var l="undefined"!==typeof n?[n,e]:[e],i=new Blob(l,{type:a||"application/octet-stream"});if("undefined"!==typeof window.navigator.msSaveBlob)window.navigator.msSaveBlob(i,t);else{var o=window.URL.createObjectURL(i),r=document.createElement("a");r.style.display="none",r.href=o,r.setAttribute("download",t),"undefined"===typeof r.download&&r.setAttribute("target","_blank"),document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(o)}}},"386d":function(e,t,a){"use strict";var n=a("cb7c"),l=a("83a1"),i=a("5f1b");a("214f")("search",1,function(e,t,a,o){return[function(a){var n=e(this),l=void 0==a?void 0:a[t];return void 0!==l?l.call(a,n):new RegExp(a)[t](String(n))},function(e){var t=o(a,e,this);if(t.done)return t.value;var r=n(e),s=String(this),c=r.lastIndex;l(c,0)||(r.lastIndex=0);var d=i(r,s);return l(r.lastIndex,c)||(r.lastIndex=c),null===d?-1:d.index}]})},5051:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-tabs",{attrs:{type:"border-card"}},[a("order-data",{attrs:{"list-data":e.listData}})],1)],1)},l=[],i=a("cebc"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"order"},[a("el-form",{ref:"formData",attrs:{inline:!0,model:e.formData,"label-width":"120px",size:"small"}},[a("el-form-item",[a("el-select",{attrs:{prop:"invoice"},on:{change:e.handleChangeSearch},model:{value:e.formData.search,callback:function(t){e.$set(e.formData,"search",t)},expression:"formData.search"}},[a("el-option",{attrs:{label:"发票单号",value:"invoiceCode"}}),e._v(" "),a("el-option",{attrs:{label:"发票抬头",value:"invoiceTitle"}}),e._v(" "),a("el-option",{attrs:{label:"订单号",value:"orderId"}})],1)],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入"+e.searchCon[e.formData.search],clearable:""},model:{value:e.formData.searchCon,callback:function(t){e.$set(e.formData,"searchCon",t)},expression:"formData.searchCon"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"流程节点：",prop:"phaseName"}},[a("el-select",{attrs:{placeholder:"请选择流程节点",clearable:""},model:{value:e.formData.phaseName,callback:function(t){e.$set(e.formData,"phaseName",t)},expression:"formData.phaseName"}},[a("el-option",{attrs:{label:"已报件",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"发票类型：",prop:"invoiceType"}},[a("el-select",{attrs:{placeholder:"请选择发票类型",clearable:""},model:{value:e.formData.invoiceType,callback:function(t){e.$set(e.formData,"invoiceType",t)},expression:"formData.invoiceType"}},[a("el-option",{attrs:{label:"电子普通发票",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"纸质普通发票",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"纸质专用发票",value:"3"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"发票状态：",prop:"invoiceStatus"}},[a("el-select",{attrs:{placeholder:"请选择发票状态",clearable:""},model:{value:e.formData.invoiceStatus,callback:function(t){e.$set(e.formData,"invoiceStatus",t)},expression:"formData.invoiceStatus"}},[a("el-option",{attrs:{label:"未开票",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"已开票",value:"2"}}),e._v(" "),a("el-option",{attrs:{label:"待邮寄",value:"3"}}),e._v(" "),a("el-option",{attrs:{label:"已邮寄",value:"4"}}),e._v(" "),a("el-option",{attrs:{label:"待红冲",value:"5"}}),e._v(" "),a("el-option",{attrs:{label:"已红冲",value:"6"}}),e._v(" "),a("el-option",{attrs:{label:"待补票",value:"7"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"申请时间：",prop:"applyTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],clearable:""},on:{change:e.handleChangeApplyTime},model:{value:e.applyTime,callback:function(t){e.applyTime=t},expression:"applyTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开票时间：",prop:"incoiveTime"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],clearable:""},on:{change:e.handleChangeIncoiveTime},model:{value:e.incoiveTime,callback:function(t){e.incoiveTime=t},expression:"incoiveTime"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.onSubmit}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-refresh",size:"small"},on:{click:function(t){return e.onReset("formData")}}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"list-header"},[a("div",{staticClass:"lf"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleClickHC}},[e._v("红冲")])],1),e._v(" "),a("div",{staticClass:"rf"},[a("el-button",{staticClass:"rf-item",attrs:{size:"mini",type:"primary"}},[a("a",{attrs:{href:"../../../../public/files/线索导入模板.xlsx",download:"邮寄模板.xlsx"}},[e._v("邮寄模板下载")])]),e._v(" "),a("upload-file",{staticClass:"rf-item",attrs:{url:e.importMail,text:"导入邮寄"}}),e._v(" "),a("upload-file",{staticClass:"rf-item",attrs:{url:e.importInvoice,text:"导入发票"}}),e._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.downloadLoading,expression:"downloadLoading"}],staticClass:"rf-item",attrs:{size:"mini",icon:"el-icon-download",type:"primary"},on:{click:e.handleClickExportInvoice}},[e._v("\n        导出发票\n      ")])],1)]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listData.listLoading,expression:"listData.listLoading"}],attrs:{data:e.listData.list,"element-loading-text":"Loading",fit:"",border:"","highlight-current-row":""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"订单号",prop:"orderId",width:"150",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.orderId||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"客户名称",width:"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.companyName||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"流程节点",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.phaseName||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票抬头",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.invoiceTitle||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单金额",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.price||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getInvoiceType(t.row.invoiceType)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"开票方式",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getOpenType(t.row.openType)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.invoiceCode||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票日期",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.invoiceDate||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票方",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.openCompany||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.operator||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"申请时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.createDate||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"申请人",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.createName||"-"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.getInvoiceStatus(t.row.invoiceStatus)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"备注信息",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.remark||"-"))])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.listData.start,"page-size":e.listData.len,layout:"total, sizes, prev, pager, next, jumper",total:e.listData.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),e._v(" "),a("dialog-hc",{attrs:{"is-show":e.isShowDialogHC,list:e.hcList,selected:e.selectList},on:{hiddenDialog:function(t){e.isShowDialogHC=!1}}})],1)},r=[],s=(a("386d"),["官费部分需要收据","官费部分不需要收据"]),c=["电子发票","普通发票","专业发票"],d=["待开票","已开票","待邮寄","已邮寄","待红冲","已红冲","待补票"],u=a("e13e");function p(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u["a"])({url:"http://192.168.91.112:10002/api/v1/zgInvoice/getInvoicePageList",method:"post",data:e})}function f(e){return Object(u["a"])({url:"http://192.168.91.112:10002/api/v1/zgInvoice/getInvoiceListByOrderId/".concat(e.invoiceId),method:"get"})}function v(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u["a"])({url:"http://192.168.91.112:10002/api/v1/zgInvoice/confirmRedDash",method:"post",data:e})}function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(u["a"])({url:"http://192.168.91.112:10002/api/v1/zgInvoice/exportInvoiceList",method:"post",responseType:"blob",data:e})}var m=a("19de"),g=a.n(m),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"红冲",visible:e.dialogHC,width:"30%"},on:{"update:visible":function(t){e.dialogHC=t}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[a("el-table-column",{attrs:{label:"发票号",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n          "+e._s(t.row.invoiceId||"-")+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n          "+e._s(t.row.orderId||"-")+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"发票抬头",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n          "+e._s(t.row.companyName||"-")+"\n        ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"订单金额（元）",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v("\n          "+e._s(t.row.price||"-")+"\n        ")])]}}])})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleClickEnsureHC}},[e._v("确 定")])],1)],1)},_=[],y={name:"InvoiceHC",props:{isShow:{type:Boolean,default:!1},list:{type:Array,default:function(){return[]}},selected:{type:Array,default:function(){return[]}}},data:function(){return{dialogHC:this.isShow}},watch:{isShow:function(e){this.dialogHC=e}},methods:{handleClickEnsureHC:function(){var e=this,t={invoiceIdList:[this.selected[0].orderId]};v(t).then(function(t){t=t.data,1e4===t.code?e.$message.success("红冲成功"):e.$message.error(t.message)}),this.$emit("hiddenDialog")}}},D=y,w=a("2877"),C=Object(w["a"])(D,b,_,!1,null,"0aad23b3",null),S=C.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("upload-file",{attrs:{"btn-word":e.text,"upload-url":e.url,"cus-file-list":e.uploadFilePicList,"file-type":!1,"show-file-list":!0},on:{resFileData:e.uploadFileData}})},T=[],x=a("e181"),I={name:"Upload",components:{UploadFile:x["a"]},props:{text:{type:String,default:""},url:{type:String,default:""}},data:function(){return{uploadFilePicList:[],followData:{companyId:null}}},methods:{uploadFileData:function(e){e.isRemove?this.followData.filePath="":this.followData.filePath=e.url}}},L=I,j=Object(w["a"])(L,k,T,!1,null,"e2b9a01c",null),$=j.exports,O={name:"OrderList",components:{dialogHc:S,uploadFile:$},props:{listData:{type:Object,default:null}},data:function(){return{mobile:"手机号",searchCon:{invoiceCode:"发票号",invoiceTitle:"发票抬头",orderId:"订单号"},applyTime:"",incoiveTime:"",formData:{len:this.listData.len,start:this.listData.start,search:"invoiceCode",searchCon:"",phaseName:"",invoiceType:"",invoiceStatus:"",createStartDate:"",createEndDate:"",invoiceStartDate:"",invoiceEndDate:""},selectList:[],hcList:[],isShowDialogHC:!1,downloadLoading:!1,importMail:"".concat("http://192.168.91.112:8001/api/v1","/zgInvoice/importInvoiceSendInfo"),importInvoice:"".concat("http://192.168.91.112:8001/api/v1","/zgInvoice/importInvoice")}},methods:{onSubmit:function(){this.formData[this.formData.search]=this.formData.searchCon,console.log(this.formData)},onReset:function(e){this.$refs[e].resetFields(),this.$message("重置搜索项!")},handleChangeSearch:function(){this.formData.searchCon=""},handleChangeApplyTime:function(){this.applyTime&&this.applyTime.length>0?(this.formData.createStartDate=this.applyTime[0],this.formData.createEndDate=this.applyTime[1]):(this.formData.createStartDate="",this.formData.createEndDate="")},handleChangeIncoiveTime:function(){this.incoiveTime&&this.incoiveTime.length>0?(this.formData.invoiceStartDate=this.incoiveTime[0],this.formData.invoiceEndDate=this.incoiveTime[1]):(this.formData.invoiceStartDate="",this.formData.invoiceEndDate="")},handleClickHC:function(){var e=this;if(0!==this.selectList.length)if(this.selectList.length>1)this.$message.error("只支持单个订单进行红冲！");else{var t={invoiceId:this.selectList[0].orderId};f(t).then(function(t){if(t=t.data,1e4===t.code){e.isShowDialogHC=!0;var a=t.data;e.hcList=a||[]}else e.$message.error(t.message)})}else this.$message.error("请在列表选中要红冲的订单")},handleClickExportInvoice:function(){var e=this;this.downloadLoading=!0;var t={length:10,start:1};h(t).then(function(t){g()(t.data,"发票.xls"),e.downloadLoading=!1}).catch(function(e){console.log(e)})},handleSelectionChange:function(e){e&&0!==e.length?this.selectList=e:this.selectList=[]},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){console.log("当前页: ".concat(e))},getOpenType:function(e){return s[e-1]||"-"},getInvoiceType:function(e){return c[e-1]||"-"},getInvoiceStatus:function(e){return d[e-1]||"-"},disposeFormData:function(){}}},z=O,H=(a("b0d0"),Object(w["a"])(z,o,r,!1,null,"bb19bffe",null)),E=H.exports,U={name:"Invoice",components:{orderData:E},data:function(){return{listData:{loading:!0,list:[],total:0,len:10,start:1}}},mounted:function(){var e=this;setTimeout(function(){e.initData()},20)},methods:{initData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object(i["a"])({dataType:!0,start:this.listData.start,len:this.listData.len},t);p(a).then(function(t){if(t=t.data,1e4===t.code){var a=t.data;e.listData.list=a.list,e.listData.total=a.totalCount}else e.$message.error(t.message)})}}},F=U,P=Object(w["a"])(F,n,l,!1,null,"31a1ae76",null);t["default"]=P.exports},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},b0d0:function(e,t,a){"use strict";var n=a("f41d"),l=a.n(n);l.a},e13e:function(e,t,a){"use strict";var n=a("bc3a"),l=a.n(n),i=a("5c96"),o=a("4360"),r=a("5f87"),s=a("a18c"),c=l.a.create({baseURL:"http://192.168.91.112:10006/api/v1",withCredentials:!1,timeout:5e3});c.interceptors.request.use(function(e){return Object(r["b"])()||s["c"].push("/login"),e.headers={"Content-Type":"application/json",token:Object(r["b"])()},e},function(e){return console.log(e),Promise.reject(e)}),c.interceptors.response.use(function(e){var t=e,a=e.data;return a.code&&1e4!==a.code?(Object(i["Message"])({message:a.message||"error",type:"error",duration:5e3}),50008!==a.code&&50012!==a.code&&50014!==a.code||i["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then(function(){o["a"].dispatch("user/resetToken").then(function(){location.reload()})}),Promise.reject(a.message||"error")):t},function(e){return console.log("err"+e),Object(i["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}),t["a"]=c},e181:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.fileType?a("el-upload",{staticClass:"uploader",class:{disabled:e.uploadDisabled},attrs:{"list-type":"picture-card",name:"file",action:e.uploadUrl,"file-list":e.fileList,"before-upload":e.handleBeforeUpload,"on-change":e.handleChange,"on-preview":e.handlePictureCardPreview,"on-success":e.handleSuccess,"on-remove":e.handleRemove}},[a("i",{staticClass:"el-icon-plus"})]):e._e(),e._v(" "),e.fileType?a("el-dialog",{attrs:{visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("img",{attrs:{width:"100%",src:e.dialogImgUrl,alt:""}})]):e._e(),e._v(" "),e.fileType?e._e():a("el-upload",{staticClass:"upload-demo",attrs:{name:"file",action:e.uploadUrl,"before-upload":e.handleBeforeUpload,"on-change":e.handleChange,"on-remove":e.handleRemove,"on-success":e.handleSuccess,limit:1,"file-list":e.fileList,headers:e.fileHeader,"show-file-list":e.showFileList}},[a("el-button",{attrs:{size:"small",type:"primary",disabled:1===e.fileList.length}},[e._v(e._s(e.btnWord))])],1)],1)},l=[],i=(a("7f7f"),a("28a5"),a("5f87")),o={name:"UploadPicture",props:{uploadUrl:{type:String,default:""},cusFileList:{type:Array,default:null},fileType:{type:Boolean},showFileList:{type:Boolean,default:!0},btnWord:{type:String,default:"点击上传"}},data:function(){return{fileList:[],dialogVisible:!1,dialogImgUrl:"",fileHeader:{token:Object(i["b"])()}}},computed:{uploadDisabled:{get:function(){return this.fileList.length>0},set:function(e){this.fileList=e}}},watch:{cusFileList:{handler:function(e,t){this.fileList=e},deep:!0,immediate:!0}},methods:{handleBeforeUpload:function(e){var t=!0;if(this.fileType)t=/^image\/(png|jpe?g|gif|bmp)$/.test(e.type);else{var a=["rar","zip","xlsx","xls","doc","docx"];-1===a.indexOf(e.name.split(".")[e.name.split.length-1])&&(t=!1)}var n=e.size/1024/1024<2;return t||(this.fileType?this.$message.error("上传头像图片只能是 JPG, PNG, GIF, BMP 格式!"):this.$message.error("上传文件只能是 rar, zip, xlsx, doc 格式!")),n||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&n},handlePictureCardPreview:function(e){this.dialogImgUrl=e.url,this.dialogVisible=!0},handleChange:function(e,t){this.fileList=t},handleSuccess:function(e,t,a){var n={};n.url=e.data,this.$emit("resFileData",n)},handleRemove:function(e,t){this.fileList=t;var a={url:"",isRemove:!0};this.$emit("resFileData",a)}}},r=o,s=(a("fee5"),a("2877")),c=Object(s["a"])(r,n,l,!1,null,"1dfc67af",null);t["a"]=c.exports},f41d:function(e,t,a){},fee5:function(e,t,a){"use strict";var n=a("02f3"),l=a.n(n);l.a}}]);