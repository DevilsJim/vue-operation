(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2116a2c3"],{"154f":function(e,t,a){"use strict";var n=a("6e61"),i=a.n(n);i.a},3243:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("customer-list-table",{attrs:{"list-data":e.listData,"active-tabs-name":e.activeTabsName},on:{fetchData:e.fetchData}})],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"customer-list-table"},[a("el-container",{attrs:{direction:"vertical"}},[a("p",{staticStyle:{"margin-bottom":"20px","border-bottom":"1px solid #e6ebf5"}},[e._v("筛选条件")]),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.formInline,size:"small"}},[a("el-form-item",{attrs:{prop:"deptName","label-width":"90px"}},[a("el-input",{attrs:{placeholder:"请输入组织名称"},model:{value:e.formInline.deptName,callback:function(t){e.$set(e.formInline,"deptName",t)},expression:"formInline.deptName"}})],1),e._v(" "),a("el-form-item",[a("el-select",{attrs:{clearable:"",placeholder:"请选择负责人"},model:{value:e.formInline.deptLeader,callback:function(t){e.$set(e.formInline,"deptLeader",t)},expression:"formInline.deptLeader"}},e._l(e.deptLeaderOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.leaderName,value:e.deptLeaderId}})}),1)],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:e.onSubmit}},[e._v("搜索")]),e._v(" "),a("el-button",{attrs:{type:"primary",icon:"el-icon-refresh",size:"small"},on:{click:e.onReset}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"success",size:"small"},on:{click:function(t){return e.addDepartment({})}}},[e._v("添加部门")])],1)],1)],1),e._v(" "),a("el-container",{attrs:{direction:"vertical"}},[a("p",[e._v("数据列表")]),e._v(" "),a("el-table",{staticStyle:{width:"100%","margin-bottom":"20px"},attrs:{data:e.tableData,"row-key":"pkSid",border:"","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}}},[a("el-table-column",{attrs:{label:"组织名称",width:"300","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.deptName)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"状态",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(1==t.row.status?"正常":"隐藏")+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"负责人",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.leaderName)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"上级组织",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.upperDeptName)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"创建时间",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.createDate)+"\n        ")]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"operation",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.editDepartment(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{attrs:{size:"mini",plain:""},on:{click:function(a){return e.deleteDepartment(t.row.pkSid)}}},[e._v("删除")]),e._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){return e.handleDepartDetail(t.row)}}},[e._v("查看")])]}}])})],1)],1),e._v(" "),a("edit-department-dialog",{attrs:{visible:e.editDepartmentVisible,"dept-list":e.deptList,"edit-data-visible":e.editData,"leader-data-visible":e.deptLeaderOptions,"add-or-edit-visible":e.addOrEdit},on:{"update:visible":function(t){e.editDepartmentVisible=t},"update:deptList":function(t){e.deptList=t},"update:dept-list":function(t){e.deptList=t},"update:editDataVisible":function(t){e.editData=t},"update:edit-data-visible":function(t){e.editData=t},"update:leaderDataVisible":function(t){e.deptLeaderOptions=t},"update:leader-data-visible":function(t){e.deptLeaderOptions=t},"update:addOrEditVisible":function(t){e.addOrEdit=t},"update:add-or-edit-visible":function(t){e.addOrEdit=t}}})],1)},r=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"创建新的部门（或组织）",visible:e.templateDialog,"close-on-click-modal":e.flag,width:"500px"},on:{"update:visible":function(t){e.templateDialog=t},close:e.closeDia,open:e.openDia}},[a("el-form",{ref:"ruleForm",attrs:{size:"mini",model:e.deptInfo,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"上级部门:"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择上级部门"},model:{value:e.deptInfo.upperDeptId,callback:function(t){e.$set(e.deptInfo,"upperDeptId",t)},expression:"deptInfo.upperDeptId"}},e._l(e.deptOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.deptName,value:e.pkSid}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"部门名称:"}},[a("el-input",{attrs:{placeholder:"请输入部门名称",clearable:""},model:{value:e.deptInfo.deptName,callback:function(t){e.$set(e.deptInfo,"deptName",t)},expression:"deptInfo.deptName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人:"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择负责人"},model:{value:e.deptInfo.deptLeaderId,callback:function(t){e.$set(e.deptInfo,"deptLeaderId",t)},expression:"deptInfo.deptLeaderId"}},[e._l(e.leaderOptions,function(e,t){return a("el-option",{key:t,attrs:{label:e.leaderName,value:e.deptLeaderId}})}),e._v(" "),a("el-option",{attrs:{label:"测试1",value:"2"}})],2)],1),e._v(" "),a("el-form-item",{attrs:{label:"状态:",prop:"onJobFlag"}},[a("el-radio",{attrs:{label:1},model:{value:e.deptInfo.status,callback:function(t){e.$set(e.deptInfo,"status",t)},expression:"deptInfo.status"}},[e._v("正常")]),e._v(" "),a("el-radio",{attrs:{label:2},model:{value:e.deptInfo.status,callback:function(t){e.$set(e.deptInfo,"status",t)},expression:"deptInfo.status"}},[e._v("隐藏")])],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small"},on:{click:function(t){e.templateDialog=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){"edit"===e.addOrEdit?e.save("ruleForm"):e.add("ruleForm")}}},[e._v("保存")])],1)],1)},d=[],l=a("5664"),u={inject:["reload"],name:"EditDepartmentDialog",props:{visible:{type:Boolean,default:!1},currentCompanyId:{type:String,default:null},currentContactId:{type:String,default:null},addEditContact:{type:Boolean,default:!1},deptList:{type:Array,default:function(){return[]}},editDataVisible:{type:Object,default:null},leaderDataVisible:{type:Array,default:function(){return[]}},addOrEditVisible:{type:String,default:null}},data:function(){return{flag:!1,templateDialog:this.visible,deptOptions:[],editDeptData:{},leaderOptions:[],deptInfo:{deptName:"",status:1,pkSid:0,deptLeaderId:"",upperDeptId:""},postData:{},addOrEdit:"add"}},watch:{visible:function(){this.templateDialog=this.visible}},methods:{closeDia:function(){this.$emit("update:visible",!1),this.deptInfo={deptName:"",status:1,pkSid:0,deptLeaderId:"",upperDeptId:""},this.editDeptData={},this.leaderOptions=[]},openDia:function(){this.deptOptions=this.deptList,this.leaderOptions=this.leaderDataVisible,"edit"===this.addOrEditVisible&&(this.deptInfo.deptName=this.editDataVisible.deptName,this.deptInfo.pkSid=this.editDataVisible.pkSid,this.deptInfo.status=this.editDataVisible.status,this.deptInfo.deptLeaderId=this.editDataVisible.deptLeaderId,this.deptInfo.upperDeptId=this.editDataVisible.upperDeptId),this.addOrEdit=this.addOrEditVisible},save:function(e){var t=this;console.log(this.deptInfo),this.$refs[e].validate(function(e){if(!e)return t.$message.warning("请完善您的数据"),!1;Object(l["t"])(t.deptInfo).then(function(e){1e4===e.data.code?(t.$message.success(e.data.message),t.reload()):t.$message.error(e.data.message),t.closeDia()}).catch(function(e){t.$message.warning(e)})})},add:function(e){var t=this;this.postData={deptLeaderId:this.deptInfo.deptLeaderId,deptName:this.deptInfo.deptName,status:this.deptInfo.status,upperDeptId:this.deptInfo.upperDeptId},this.$refs[e].validate(function(e){if(!e)return t.$message.warning("请完善您的数据"),!1;Object(l["a"])(t.postData).then(function(e){1e4===e.data.code?(t.$message.success(e.data.message),t.reload()):t.$message.error(e.data.message),t.closeDia()}).catch(function(e){t.$message.warning(e)})}),console.log(this.postData)}}},c=u,p=(a("ec8d"),a("2877")),f=Object(p["a"])(c,o,d,!1,null,"8d2479c2",null),m=f.exports,h={inject:["reload"],name:"CustomerListTable",components:{EditDepartmentDialog:m},props:{listData:{type:Object,default:null},activeTabsName:{type:String,default:null}},data:function(){return{list:[],deptLeaderOptions:[],deptList:[],editData:{},deletePksid:0,searchCriteria:null,searchCon:"",searchPlaceholder:null,isSearchConShow:!1,formInline:{},editDepartmentVisible:!1,addOrEdit:"add"}},watch:{listData:{handler:function(e,t){var a=this;this.list=e.list,this.tableData=e.list,this.deptLeaderOptions=[],e.list.map(function(e,t){a.deptLeaderOptions.push({leaderName:e.leaderName,deptLeaderId:e.deptLeaderId}),a.deptList.push({deptName:e.deptName,pkSid:e.pkSid}),e.children&&e.children.map(function(e,t){a.deptLeaderOptions.push({leaderName:e.leaderName,deptLeaderId:e.deptLeaderId}),a.deptList.push({deptName:e.deptName,pkSid:e.pkSid}),e.children&&e.children.map(function(e,t){e.leaderName&&a.deptLeaderOptions.push({leaderName:e.leaderName,deptLeaderId:e.deptLeaderId}),a.deptList.push({deptName:e.deptName,pkSid:e.pkSid})})})});var n={};this.deptLeaderOptions=this.deptLeaderOptions.reduce(function(e,t){return!n[t.deptLeaderId]&&(n[t.deptLeaderId]=e.push(t)),e},[]),this.deptList=this.deptList.reduce(function(e,t){return!n[t.pkSid]&&(n[t.pkSid]=e.push(t)),e},[])},deep:!0,immediate:!0},formInline:{handler:function(e,t){},deep:!0,immediate:!0},searchCriteria:{handler:function(e,t){null!==e?(this.isSearchConShow=!0,this.searchPlaceholder="请输入"+this.searchCriteriaTxt[e]):(this.isSearchConShow=!1,this.searchPlaceholder=""),this.searchCon="",this.formInline.companyName=null,this.formInline.latentNickName=null,this.formInline.latentUserMobile=null,this.formInline.latentTelephone=null},deep:!0,immediate:!0},searchCon:{handler:function(e,t){null!==this.searchCriteria&&(this.formInline[this.searchCriteria]=e,console.log(this.formInline))},deep:!0,immediate:!0},followUpVisible:function(e,t){e||this.$emit("fetchData",this.formInline)}},methods:{onSubmit:function(){this.$message.success("搜索成功!"),this.$emit("fetchData",this.formInline)},onReset:function(){this.formInline={start:"1",length:"10",currentUserId:"133",deleteStatus:"0"},this.searchCriteria=null,this.followTime=null,this.createdTime=null,this.$message("重置搜索项!")},handleDepartDetail:function(e){console.log(e);var t="?upperDeptName="+e.upperDeptName+"&leaderName="+e.leaderName+"&status="+e.status;this.$router.push({path:"/rightsManagement/departmentDetail"+t})},addDepartment:function(e){this.editDepartmentVisible=!0,this.editData=e,this.addOrEdit="add"},editDepartment:function(e){this.editDepartmentVisible=!0,this.editData=e,this.addOrEdit="edit"},deleteDepartment:function(e){var t=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(l["g"])({pkSid:e}).then(function(e){1e4===e.data.code?(t.$message({type:"success",message:"删除成功!"}),t.reload()):t.$message({type:"info",message:"删除失败"})}).catch(function(e){t.$message.error(e)})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},objReduce:function(e,t){var a=[],n={};return a=e.reduce(function(e,t){return!n[t._index]&&(n[t._index]=e.push(t)),e},[]),a}}},b=h,g=(a("154f"),Object(p["a"])(b,s,r,!1,null,"7e3bda51",null)),v=g.exports,y={name:"OrganizationStructure",components:{CustomerListTable:v},data:function(){return{activeTabsName:"0",formInline:{},listData:{list:[],listLoading:!0,total:0},currentPage4:4,createdCustomerVisible:!1,followUpVisible:!1,chooseOrderWayVisible:!1,valetOrderVisible:!1}},watch:{activeTabsName:{handler:function(e,t){this.formInline.selectType=e,this.fetchData()},deep:!0,immediate:!0}},created:function(){},methods:{onSubmit:function(){this.$message("submit!")},handleSelectionChange:function(e){console.log(e)},fetchData:function(e){var t=this;"undefined"!==typeof e&&(this.formInline=e),this.$set(this.listData,"listLoading",!0),Object(l["k"])(this.formInline).then(function(e){t.listData=Object.assign({},t.listData,{list:e.data.data,listLoading:!1})}).catch(function(e){console.log("err",e)})},handleSizeChange:function(e){console.log("每页 ".concat(e," 条"))},handleCurrentChange:function(e){console.log("当前页: ".concat(e))},createdCustomer:function(){this.createdCustomerVisible=!0},handleFollowUp:function(){this.followUpVisible=!0},handleChooseOrderWay:function(){this.chooseOrderWayVisible=!0},handleValetOrder:function(){this.valetOrderVisible=!0}}},D=y,I=Object(p["a"])(D,n,i,!1,null,"208c3178",null);t["default"]=I.exports},5664:function(e,t,a){"use strict";a.d(t,"k",function(){return i}),a.d(t,"a",function(){return s}),a.d(t,"t",function(){return r}),a.d(t,"o",function(){return o}),a.d(t,"g",function(){return d}),a.d(t,"q",function(){return l}),a.d(t,"p",function(){return u}),a.d(t,"s",function(){return c}),a.d(t,"x",function(){return p}),a.d(t,"u",function(){return f}),a.d(t,"d",function(){return m}),a.d(t,"j",function(){return h}),a.d(t,"h",function(){return b}),a.d(t,"n",function(){return g}),a.d(t,"b",function(){return v}),a.d(t,"v",function(){return y}),a.d(t,"e",function(){return D}),a.d(t,"l",function(){return I}),a.d(t,"m",function(){return O}),a.d(t,"c",function(){return L}),a.d(t,"w",function(){return _}),a.d(t,"f",function(){return S}),a.d(t,"i",function(){return k}),a.d(t,"r",function(){return j});var n=a("e13e");function i(e){return Object(n["a"])({url:"/sysDept/getDeptTreeList",method:"post",data:e})}function s(e){return Object(n["a"])({url:"/sysDept/save",method:"post",data:e})}function r(e){return Object(n["a"])({url:"/sysDept/update",method:"post",data:e})}function o(e){return Object(n["a"])({url:"/sysUser/getSysUserPageList",method:"post",data:e})}function d(e){return Object(n["a"])({url:"/sysDept/delete",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/sysUser/getSysUserPageList",method:"post",data:e})}function u(e){return Object(n["a"])({url:"/sysUser/selectByID/"+e,method:"get"})}function c(e){return Object(n["a"])({url:"/sysUser/resetPwdByID/"+e,method:"get",data:e})}function p(e){return Object(n["a"])({url:"/sysUser/update",method:"post",data:e})}function f(e){return Object(n["a"])({url:"/sysUser/updateOffWorkFlag",method:"post",data:e})}function m(e){return Object(n["a"])({url:"/sysUser/save",method:"post",data:e})}function h(e){return Object(n["a"])({url:"/sysDept/getDeptList",method:"get",data:e})}function b(e){return Object(n["a"])({url:"/sysUser/exportSysUserList",method:"post",data:e,responseType:"blob"})}function g(){return Object(n["a"])({url:"/sysMenu/getSysMenuTree",method:"get"})}function v(e){return Object(n["a"])({url:"/sysMenu/saveSysMenu",method:"post",data:e})}function y(e){return Object(n["a"])({url:"/sysMenu/updateSysMenuByPkSid",method:"post",data:e})}function D(e){return Object(n["a"])({url:"/sysMenu/deleteSysMenuByPkSid/"+e,method:"get"})}function I(e){return Object(n["a"])({url:"/sysRole/getSysRolePageList/",method:"post",data:e})}function O(e){return Object(n["a"])({url:"/sysRoleMenu/getSysRoleMenuList",method:"post",data:e})}function L(e){return Object(n["a"])({url:"/sysRole/saveSysRole",method:"post",data:e})}function _(e){return Object(n["a"])({url:"/sysRole/updateSysRoleByPkSid",method:"post",data:e})}function S(e){return Object(n["a"])({url:"/sysRole/deleteSysRoleByPkSid/"+e,method:"get"})}function k(){return Object(n["a"])({baseURL:"http://192.168.91.112:10006/api/v1/sysUser/getCurrentUserDeptUsers",method:"get"})}function j(e){return Object(n["a"])({baseURL:"http://192.168.91.112:10006/api/v1/sysUser/getSysUserPageList",method:"post",data:e})}},"6e61":function(e,t,a){},e13e:function(e,t,a){"use strict";var n=a("bc3a"),i=a.n(n),s=a("5c96"),r=a("4360"),o=a("5f87"),d=a("a18c"),l=i.a.create({baseURL:"http://192.168.91.112:10006/api/v1",withCredentials:!1,timeout:5e3});l.interceptors.request.use(function(e){return Object(o["b"])()||d["c"].push("/login"),e.headers={"Content-Type":"application/json",token:Object(o["b"])()},e},function(e){return console.log(e),Promise.reject(e)}),l.interceptors.response.use(function(e){var t=e,a=e.data;return a.code&&1e4!==a.code?(Object(s["Message"])({message:a.message||"error",type:"error",duration:5e3}),50008!==a.code&&50012!==a.code&&50014!==a.code||s["MessageBox"].confirm("You have been logged out, you can cancel to stay on this page, or log in again","Confirm logout",{confirmButtonText:"Re-Login",cancelButtonText:"Cancel",type:"warning"}).then(function(){r["a"].dispatch("user/resetToken").then(function(){location.reload()})}),Promise.reject(a.message||"error")):t},function(e){return console.log("err"+e),Object(s["Message"])({message:e.message,type:"error",duration:5e3}),Promise.reject(e)}),t["a"]=l},ec8d:function(e,t,a){"use strict";var n=a("fb7a"),i=a.n(n);i.a},fb7a:function(e,t,a){}}]);